# Pro Multi-Tab Notepad

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![CustomTkinter](https://img.shields.io/badge/UI-CustomTkinter-orange.svg)

Pro Multi-Tab Notepad は、Python と CustomTkinter を使用して構築された、理系学生・エンジニア向けのマルチタブ型テキストエディタです。
通常のテキスト編集に加え、LaTeX 数式、化学構造式（mhchem）のリアルタイムプレビューに対応しています。

---

## 🌟 主な特徴

- **理系特化 Markdown 支援**:
  - **LaTeX 数式**: 高度な数学記号・積分のレンダリングに対応。
  - **化学式 (mhchem)**: 分子式 $\ce{H2O}$ や反応式 $\ce{2H2 + O2 -> 2H2O}$ を美しく表示。
  - **ブラウザプレビュー**: ワンクリック（または `Ctrl+Shift+P`）でスタイリッシュな HTML プレビューを表示。
- **ライブ・プレビュー**:
  - **自動更新**: 10秒ごとに編集内容がブラウザに自動反映。設定から更新間隔を **1秒〜60秒** の間で変更可能。
  - **再読み込み不要**: 一度ブラウザを開けば、保存操作なしで最新の LaTeX や Markdown を確認可能。
- **モダンな UI/UX**:
  - **ショートカット・ツールチップ**: ツールバーのボタンにホバーすると、対応するショートカットキーを表示。
  - ダークモード/ライトモードの完全切り替え。
- **コーディング支援**:
  - **シンタックスハイライト**: Python, HTML, CSS, JS, Markdown に対応。
  - **視覚ガイド**: 行番号表示、グリッド線表示、現在行ハイライト機能。
- **検索機能**: リアルタイムハイライトと前後へのナビゲーション。
- **多言語対応 (i18n)**: 日本語と英語の UI 切り替えに対応。
- **自動ディレクトリ作成**: ユーザーのホームディレクトリに専用の保存フォルダを自動作成。
- **自動アップデート確認**: GitHub API を利用し、最新版がある場合に通知を表示。

## 🌟 新機能 (v1.5.0)

- **万能インポート機能** (Bundle形式)
 - スマート変換: .docx や .html をワンクリックで Markdown へ変換。
 - アセット管理: 変換時に [ファイル名]_bundle フォルダを自動生成し、文書内の画像を assets/ フォルダへ自動抽出。
 - リンク自動解決: Markdown 内の画像パスを相対パス（assets/image.png）に自動書き換え。
 - 選択的インポート: HTML/CSS を開く際、「Markdownに変換してインポート」か「ソースコードとして直接編集」かを選択可能。

- Markdown 編集ツールバー
 - コンテキスト対応: .md ファイルを編集している時だけ、エディタ上部に専用の補助ツールバーが出現。
 - 直感操作: 見出し（H1/H2）、強調、斜体、箇条書き、テーブル雛形の挿入をワンクリックで実行。
 - 動的レイアウト: タブバーや行番号と干渉しない独立したグリッド配置を採用。

- プレビュー・視覚体験の強化
 - 相対パスプレビュー: <base> タグの動的挿入により、ローカルの assets/ 内にある画像をプレビュー上で正しく表示。

## 📁 Bundle形式のディレクトリ構造

インポート機能を利用すると、アセットを含めたプロジェクト管理が容易になります。

```text
[ファイル名]_bundle/
├── index.md        # 変換されたMarkdown本体
└── assets/         # 抽出された画像ファイル群
```

## ⌨️ ショートカットキー

| キー組合せ | 機能 |
| :---: | :---: |
| Ctrl + N | 新規タブの作成 |
| Ctrl + O | ファイルを開く |
| Ctrl + S | ファイルを保存 |
| Ctrl + Shift + P | Markdown プレビュー表示 |
| Ctrl + Z | Undo |
| Ctrl + Shift + Z | Redo |
| Ctrl + F | 検索パネルの表示/非表示 |
| Ctrl + , | 設定画面の表示/非表示 |
| Ctrl + L / G / H | 行番号 / 罫線 / 現在行強調 の切替 |

## ⚙️ 設定オプション
設定画面（Ctrl + ,）から以下の項目を自由にカスタマイズし、即座に反映させることができます。

- 外観: ライトモード / ダークモード。

- エディタ: フォントサイズ変更、各種視覚ガイド（行番号・罫線・強調）の ON/OFF。

- ファイル: デフォルトの保存先ディレクトリ。

- 言語: 日本語 / 英語。

## 📁 専用フォルダについて
初回起動時に、利便性のために以下のディレクトリが自動的に作成され、デフォルトの保存先として設定されます。

パス: ~/ProMultiTabNotepad (ユーザーホームディレクトリ内)

## Releaseにて.exeファイルを公開中・以下の手順はコマンドで実行するもの

## 🚀 はじめかた

### 1. 動作環境
- Python 3.8 以上

### 2. ライブラリのインストール
ターミナルまたはコマンドプロンプトで以下のコマンドを実行してください。

```bash
pip install -r requirements.txt
```

### 3. アプリの起動

メインスクリプトを実行します。

```bash
python my_notepad_app.py
```

## 🛠 開発者向け情報
このアプリは Mixin パターン を採用しており、機能ごとに独立したクラスで構成されています。

- TabOperationsMixin: タブ操作（追加・削除・切替）。

- FileOperationsMixin: ファイル I/O。

- SearchOperationsMixin: 検索 UI およびロジック。

- SettingsOperationsMixin: 設定値の管理と UI 制御。

## 🛠 技術スタック
- GUI: CustomTkinter

- Markdown: markdown2 (with extras)

- Math/Chemistry: MathJax 3.0 (mhchem extension)

- Automation: GitHub Actions (PyInstaller build)

### バージョン番号
バージョン番号は X.Y.Z （例：1.1.2）の形式で表し、それぞれの数字に明確な意味を持たせます。

|項目|呼び方|更新するタイミング|例|
|:---:|:---:|:---:|:---:|
|X|メジャー (Major)|互換性のない 大幅な変更。使い方がガラッと変わる時。|1.1.2 → 2.0.0
|Y|マイナー (Minor)|互換性を保ちつつ、新機能を追加した時。|1.1.2 → 1.2.0
|Z|パッチ (Patch)|互換性を保ちつつ、バグ修正や細かな調整をした時。|1.1.2 → 1.1.3

## 📄 ライセンス


Produced with passion for clean coding.
